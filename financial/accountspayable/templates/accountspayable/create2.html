{% extends 'base-form.html' %}
{% load staticfiles %}
{% block page-title %} Accounts Payable {% endblock page-title %}
{% block page-content %}
{% block extra_css %}
    {% include "accountspayable/createcss.html" %}
{% endblock extra_css %}
<div class="panel">
    <div class="panel-body container-fluid">
        <div class="row">
            <div class="panel margin-bottom-20">
                <div class="panel-heading">
                    <h3 class="panel-title">CREATE</h3>
                </div>
                <div class="panel-body">





                    <div class="form-group col-sm-6">
                        <div class="col-sm-6">
                            AP Number(FROM)
                            <input type="number" class="form-control input-sm" id="cache_apnum_from" value="2017000001">
                        </div>
                        <div class="col-sm-6">
                            AP Number(TO)
                            <input type="number" class="form-control input-sm" id="cache_apnum_to" value="2017000001">
                            <br>
                            <button id="cache_submit" class="btn">Search</button>
                            <button id="cache_clear" class="btn">Clear History</button>
                        </div>

{#                        <div class="col-sm-12">#}
{#                            <table id="cached" class="table">#}
{#                                <thead>#}
{#                                    <tr>#}
{#                                        <th colspan="2">Cached result</th>#}
{#                                    </tr>#}
{#                                    <tr>#}
{#                                        <th>ID</th>#}
{#                                        <th>Keyword</th>#}
{#                                    </tr>#}
{#                                </thead>#}
{#                                <tbody></tbody>#}
{#                            </table>#}
{#                        </div>#}
                    </div>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
</div>
{% endblock page-content %}
{% block extra_js %}
<script src="{% static 'financial-layout/assets/plugin/bootstrap-datepicker/js/bootstrap-datepicker.min.js' %}"></script>
<script src="{% static 'financial-layout/assets/plugin/bootstrap-datepicker/js/custom-datepicker.js' %}"></script>
<script src="{% static 'js/jquery.validate.js' %}" type="text/javascript"></script>
<script src="{% static 'financial-layout/assets/plugin/select2/js/select2.min.js' %}"></script>
<script src="{% static 'js/jquery.maskMoney.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/custom-maskMoney.js' %}" type="text/javascript"></script>
<script src="{% static 'financial-layout/assets/plugin/bootstrap-wysihtml5-0.0.2/libs/js/wysihtml5-0.3.0_rc2.min.js' %}"></script>
<script src="{% static 'financial-layout/assets/plugin/bootstrap-wysihtml5-0.0.2/bootstrap-wysihtml5-0.0.2.min.js' %}"></script>
<script type="text/javascript">
$(function() {
    // caching
    var cachedItems = [];
    var retrieveItems = localStorage.getItem('cachedItems');

    $('#cache_clear').on('click', function () {
        localStorage.removeItem('cachedItems');
    });

    function cachedsearch(table) {
        url = "/utils/ajaxsearch/";
        $.ajax({
            url: url,
            type: "post",
            data: {
                'cache_apnum_from': $("#cache_apnum_from").val(),
                'cache_apnum_to': $("#cache_apnum_to").val(),
                'table': table
            },
            success: function (response) {
                if (response.items != "[]") {
                    for (var i = 0; i < response.items.length; i++) {
                        cachedItems.push({
                            id: response.items[i].id,
                            text: response.items[i].text
                        });
                    }
                    localStorage.setItem('cachedItems', JSON.stringify(cachedItems));
                }
            }
            , error: function (response) {
                console.debug(response);
            }
        });
    }




    console.log(JSON.parse(retrieveItems));
    $('#cache_submit').on('click', function () {
        cachedsearch('apmain');
    });














     //$(document).ready(function(){
    //    if (JSON.parse(retrieveItems) != null){
    //        $('#cached tbody').html('');
    //        for (var i = 0; i < JSON.parse(retrieveItems).length; i++) {
    //            $('#cached tbody').append("<tr>" +
    //                        "<td>" + JSON.parse(retrieveItems)[i]['id'] + "</td>" +
    //                        "<td>" + JSON.parse(retrieveItems)[i]['text'] + "</td>" +
    //                    "</tr>");
    //        }
    //    }
    //});
{#    $('#cache_submit').on('click', function(){#}
{#        url = "/utils/ajaxsearch/";#}
{#        $.ajax({#}
{#            url: url,#}
{#            type: "post",#}
{#            data: {#}
{#                'cache-apnum-from': $("#cache-apnum-from").val(),#}
{#                'cache-apnum-to': $("#cache-apnum-to").val(),#}
{#                'table': 'supplier'#}
{#            },#}
{#            success: function(response) {#}
{#                if(response.items != "[]"){#}
{#                    $('#cached tbody').html('');#}
{#                    for (var i = 0; i < response.items.length; i++) {#}
{#                        $('#cached tbody').append("<tr>" +#}
{#                                    "<td>" + response.items[i].id + "</td>" +#}
{#                                    "<td>" + response.items[i].text + "</td>" +#}
{#                                "</tr>");#}
{#                        cachedItems.push({#}
{#                            id: response.items[i].id,#}
{#                            text: response.items[i].text#}
{#                        });#}
{#                    }#}
{#                    localStorage.setItem('cachedItems', JSON.stringify(cachedItems));#}
{#                }#}
{#            }#}
{#            , error: function(response) {#}
{#                console.debug(response);#}
{#            }#}
{#        });#}
{#    });#}
});
</script>
{% endblock extra_js %}