{% extends 'base-form.html' %}
{% load staticfiles %}
{% block page-title %} Official Receipt {% endblock page-title %}
{% block page-content %}
{% block extra_css %}
    <link rel="stylesheet" href="{% static 'financial-layout/assets/css/dashboard/dashboard.css' %}" />
    <link rel="stylesheet" href="{% static 'financial-layout/assets/plugin/select2/css/select2.css' %}" />
    <link rel="stylesheet" href="{% static 'financial-layout/assets/plugin/bootstrap-datepicker/css/bootstrap-datepicker.min.css' %}" /><style>
        .widgett {
            margin-bottom: 10px;
        }
        .vattable td{
        }
            text-align: right;
        }
        .vattable td:first-child {
            width: 170px;
            padding-right: 20px;
        }
        .vattable td input {
            width: 100px;
            text-align: right;
        }
        .heading-top-index-2 {
            padding-right: 15px;
            padding-left: 45px;
        }
        .form-control.input-sm.date-yyyymmdd.datepicker.week {
            background-color: transparent;
        }
        .payee_options{
            display: none;
        }
        hr{
            margin-top: 10px;
            margin-bottom: 15px;
        }
    </style>
{% endblock extra_css %}
<div class="panel">
    <div class="panel-body container-fluid">
        <div class="row">
            <div class="margin-bottom-20">
                <!-- Start Simple Form Validation -->
                <h3 class="panel-title" style="padding:5px 10px 20px 25px;">Create</h3>
                <form autocomplete="off" id="form-b" method="post">
                    {% csrf_token %}
                    <div class="col-sm-12">
                        <div class="form-group col-sm-2">
                            <label class="control-label" for="id_ornum">Number</label>
                            <input type="text" class="form-control input-sm disabled-white" placeholder="JVxxxxxxx" disabled="disabled">
                        </div>
                        <div class="form-group col-sm-2 {{ form.ordate.errors|yesno:'has-error,' }}">
                            <label class="control-label" for="id_prdate">Date</label>
                            <input type="text" class="form-control input-sm date-yyyymmdd datepicker week" readonly="readonly" style="padding: 5px 10px" id="id_prdate" name="prdate" placeholder="YYYY-MM-DD" data-validation="required" value="{% if form.ordate.value %}{{ form.ordate.value }}{% else %}{% now "Y-m-d" %}{% endif %}">
                            <span class="help-block form-error">{{ form.ordate.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-2 {{ form.ortype.errors|yesno:'has-error,' }}">
                            <label class="control-label" for="id_ortype">OR Type</label>
                            <select class="form-control input-sm" data-validation="required" id="id_ortype" name="ortype">
                                <option value="">-- Select --</option>
                                {% for data in ortype %}
                                    <option value="{{ data.id }}" {% if form.ortype.value|add:0 == data.id %} selected="selected" {% endif %}>{{ data.description }}</option>
                                {% endfor %}
                            </select>
                            <span class="help-block form-error">{{ form.ortype.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-2 {{ form.orsource.errors|yesno:'has-error,' }}">
                            <label class="control-label" for="id_orsource">OR Source</label>
                            <select class="form-control input-sm" data-validation="required" id="id_orsource" name="orsource">
                                <option value="">-- Select --</option>
                                <option value="A" {% if form.orsource.value == "A" %} selected="selected" {% endif %}>Advertising</option>
                                <option value="C" {% if form.orsource.value == "C" %} selected="selected" {% endif %}>Circulation</option>
                            </select>
                            <span class="help-block form-error">{{ form.orsource.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-2 {{ form.prnum.errors|yesno:'has-error,' }}">
                            <label class="control-label" for="id_prnum">PR #</label>
                            <input type="text" class="form-control input-sm" id="id_prnum" name="prnum" placeholder="PR #" value="{{ form.prnum.value|default:'' }}">
                            <span class="help-block form-error">{{ form.prnum.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-2 {{ form.prdate.errors|yesno:'has-error,' }}">
                            <label class="control-label" for="id_prdate">PR Date</label>
                            <input type="text" class="form-control input-sm date-yyyymmdd datepicker week" readonly="readonly" style="padding: 5px 10px" id="id_prdate" name="prdate" placeholder="YYYY-MM-DD" data-validation="required" value="{% if form.prdate.value %}{{ form.prdate.value }}{% else %}{% now "Y-m-d" %}{% endif %}">
                            <span class="help-block form-error">{{ form.ortype.errors.as_text }}</span>
                        </div>
                        <div class="col-md-12"><hr></div>
                        <!--------------------------------------------------------------------------------------------->

                        <div class="form-group col-sm-4 {{ form.collector.errors|yesno:'has-error,' }}">
                            <label class="control-label" for="id_collector">Collector</label>
                            <select class="form-control input-sm select2" id="id_collector" name="collector">
                                <option value="">-- Select --</option>
                                {% for data in collector %}
                                    <option value="{{ data.id }}" {% if form.collector.value|add:0 == data.id %} selected="selected" {% endif %}>[{{ data.code }}] {{ data.name }}</option>
                                {% endfor %}
                            </select>
                            <span class="help-block form-error">{{ form.collector.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-2 {{ form.branch.errors|yesno:'has-error,' }}">
                            <label class="control-label" for="id_branch">Branch</label>
                            <select class="form-control input-sm" data-validation="required" id="id_branch" name="branch">
                                <option value="">-- Select --</option>
                                {% for data in branch %}
                                    <option value="{{ data.id }}" {% if form.branch.value|add:0 == data.id %} selected="selected" {% endif %}>{{ data.description }}</option>
                                {% endfor %}
                            </select>
                            <span class="help-block form-error">{{ form.branch.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-2 {{ form.payee_type.errors|yesno:'has-error,' }}">
                            <label class="control-label" for="id_payee_type">Payee Type</label>
                            <select class="form-control input-sm" data-validation="required" id="id_payee_type" name="payee_type">
                                <option value="AG" {% if form.orsource.value == "AG" %} selected="selected" {% endif %}>Agency</option>
                                <option value="C" {% if form.orsource.value == "C" %} selected="selected" {% endif %}>Client</option>
                                <option value="A" {% if form.orsource.value == "A" %} selected="selected" {% endif %}>Agent</option>
                            </select>
                            <span class="help-block form-error">{{ form.payee_type.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-4 payee_options">
                            <label class="control-label" for="id_agency">Agency</label>
                            <select class="form-control input-sm" id="id_agency" style="width: 100%"></select>
                            <span class="help-block form-error">{{ form.agency.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-4 payee_options">
                            <label class="control-label" for="id_client">Client</label>
                            <select class="form-control input-sm" id="id_client" style="width: 100%"></select>
                            <span class="help-block form-error">{{ form.client.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-4 payee_options">
                            <label class="control-label" for="id_agent">Agent</label>
                            <select class="form-control input-sm" id="id_agent" style="width: 100%"></select>
                            <span class="help-block form-error">{{ form.agent.errors.as_text }}</span>
                        </div>
                        <div class="col-md-12"><hr></div>
                        <!--------------------------------------------------------------------------------------------->
                    </div>
                    <div class="col-md-8">
                        <div class="form-group col-sm-12 {{ form.amount.errors|yesno:'has-error,' }}" style="min-height: 115px;">
                            <label class="control-label" for="id_amount">Amount</label>
                            <input type="text" class="form-control input-sm" id="id_amount" readonly="readonly" style="background-color: transparent" value="{{ form.amount.value|default:'' }}"><br>
                            <div style="text-align: right; margin-top: -15px;"><code>One Hundred Thirty Five Thousand Three Hundred Eighty Five Pesos and 98/100 Only</code></div>
                            <span class="help-block form-error">{{ form.amount.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-10 {{ form.outputvattype.errors|yesno:'has-error,' }}">
                            <label class="control-label" for="id_outputvattype">Output VAT Type</label>
                            <select class="form-control input-sm" data-validation="required" id="id_outputvattype" name="outputvattype">
                                <option value="">-- Select --</option>
                                {% for data in outputvattype %}
                                    <option value="{{ data.id }}" {% if form.outputvattype.value|add:0 == data.id %} selected="selected" {% endif %}>{{ data.description }}</option>
                                {% endfor %}
                            </select>
                            <span class="help-block form-error">{{ form.outputvattype.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-2 {{ form.deferredvat.errors|yesno:'has-error,' }}">
                            <label class="control-label" for="id_deferredvat">Deferred VAT</label>
                            <select class="form-control input-sm" data-validation="required" id="id_deferredvat" name="deferredvat">
                                {% for id,name in form.fields.deferredvat.choices %}
                                    <option value="{{ id }}"{% if form.deferredvat.value == id %} selected{% endif %}>{% ifequal id ""%}-- Select --{% else %}{{ name }}{% endifequal %}</option>
                                {% endfor %}
                            </select>
                            <span class="help-block form-error">{{ form.deferredvat.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-4 {{ form.vat.errors|yesno:'has-error,' }}">
                            <label class="control-label" for="id_vat">VAT</label>
                            <select class="form-control input-sm" data-validation="required" id="id_vat" name="vat">
                                <option value="">-- Select --</option>
                                {% for data in vat %}
                                    <option value="{{ data.id }}" {% if form.vat.value|add:0 == data.id %} selected="selected" {% endif %}>{{ data.description }}</option>
                                {% endfor %}
                            </select>
                            <span class="help-block form-error">{{ form.vat.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-2 padding-top-30"><span id="vatrate" class="text-success small"><strong>RATE</strong></span></div>
                        <div class="form-group col-sm-4 {{ form.wtax.errors|yesno:'has-error,' }}">
                            <label class="control-label" for="id_wtax">WTAX</label>
                            <select class="form-control input-sm" data-validation="required" id="id_wtax" name="wtax">
                                <option value="">-- Select --</option>
                                {% for data in wtax %}
                                    <option value="{{ data.id }}" {% if form.wtax.value|add:0 == data.id %} selected="selected" {% endif %}>{{ data.description }}</option>
                                {% endfor %}
                            </select>
                            <span class="help-block form-error">{{ form.wtax.errors.as_text }}</span>
                        </div>
                        <div class="form-group col-sm-2 padding-top-30"><span id="wtaxrate" class="text-success small"><strong>RATE</strong></span></div>
                    </div>
                    <div class="col-md-4">
                        <div class="widgett widgett-article widgett-shadow">
                            <div class="heading-top-index-2">
                                <table class="vattable">
                                    <tr>
                                        <td><small>VATable&nbsp;Sale:</small></td>
                                        <td class="form-group form-material"><input type="text" class="form-control input-sm amount" disabled="disabled" value="0"></td>
                                    </tr>
                                    <tr>
                                        <td><small>VAT-Exempt&nbsp;Purchase:</small></td>
                                        <td class="form-group form-material"><input type="text" class="form-control input-sm amount" disabled="disabled" value="0"></td>
                                    </tr>
                                    <tr>
                                        <td><small>VAT&nbsp;Zero&nbsp;-&nbsp;Rated&nbsp;Purchase:</small></td>
                                        <td class="form-group form-material"><input type="text" class="form-control input-sm amount" disabled="disabled" value="0"></td>
                                    </tr>
                                    <tr><td colspan="0"><br></td></tr>
                                    <tr>
                                        <td><small><b>Total&nbsp;Sale:</b></small></td>
                                        <td class="form-group form-material"><input type="text" class="form-control input-sm amount" disabled="disabled" value="0"></td>
                                    </tr>
                                    <tr>
                                        <td><small><b>Add&nbsp;VAT:</b></small></td>
                                        <td class="form-group form-material"><input type="text" class="form-control input-sm amount" disabled="disabled" value="0"></td>
                                    </tr>
                                    <tr>
                                        <td><small><b>Total&nbsp;Payment:</b></small></td>
                                        <td class="form-group form-material"><input type="text" class="form-control input-sm amount" disabled="disabled" value="0"></td>
                                    </tr>
                                    <tr>
                                        <td colspan="2" style="text-align: right; padding-right: 0px; padding-top: 10px;"><code>Noted: 1% w/tax -------> 121.24</code></td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12"><hr></div>
                    <!--------------------------------------------------------------------------------------------->
                    <div class="form-group col-sm-3 {{ form.particulars.errors|yesno:'has-error,' }}">
                        <label class="control-label" for="id_particulars">Particulars</label>
                        <textarea id="id_particulars" class="form-control input-sm" name="particulars" rows="1"></textarea>
                        <span class="help-block form-error">{{ form.particulars.errors.as_text }}</span>
                    </div>
                    <div class="form-group col-sm-3 {{ form.remarks.errors|yesno:'has-error,' }}">
                        <label class="control-label" for="id_remarks">Remarks</label>
                        <textarea id="id_remarks" class="form-control input-sm" name="remarks" rows="1"></textarea>
                        <span class="help-block form-error">{{ form.remarks.errors.as_text }}</span>
                    </div>
                    <div class="form-group col-sm-2 {{ form.orstatus.errors|yesno:'has-error,' }}">
                        <label class="control-label" for="id_orstatus">OR Status</label>
                        <input type="text" disabled="disabled" value="For Approval" class="form-control input-sm disabled-white">
                        <span class="help-block form-error">{{ form.orstatus.errors.as_text }}</span>
                    </div>
                    <div class="form-group col-sm-4">
                        <label class="control-label" for="id_bankaccount">Bank Account</label>
                        <select id="id_bankaccount" class="form-control input-sm select2" name="bankaccount">
                            <option value="">-- Select --</option>
                            {% for data in bankaccount %}
                                <option value="{{ data.id }}" {% if form.bankaccount.value|add:0 == data.id %} selected="selected" {% endif %}>{{ data.code }} [{{ data.bank.description }} - {{ data.bankaccounttype.description }}, {{ data.bankbranch.description }}]</option>
                            {% endfor %}
                        </select>
                        <span class="help-block form-error">{{ form.bankaccount.errors.as_text }}</span>
                    </div>
                    <div class="form-group col-sm-4 {{ form.designatedapprover.errors|yesno:'has-error,' }}">
                        <label class="control-label" for="id_designatedapprover">Approver</label>
                        <select id="id_designatedapprover" class="form-control input-sm select2" name="designatedapprover">
                            <option value="">-- Select --</option>
                            {% for data in designatedapprover %}
                                <option value="{{ data.id }}" {% if form.designatedapprover.value|add:0 == data.id %} selected="selected" {% endif %}>{{ data.first_name }} {{ data.last_name }}</option>
                            {% endfor %}
                        </select>
                        <span class="help-block form-error">{{ form.designatedapprover.errors.as_text }}</span>
                    </div>
                    <div class="form-group col-sm-4 {{ form.product.errors|yesno:'has-error,' }}">
                        <label class="control-label" for="id_product">Product</label>
                        <select id="id_product" class="form-control input-sm select2" name="product">
                            <option value="">-- Select --</option>
                            {% for data in product %}
                                <option value="{{ data.id }}" {% if form.product.value|add:0 == data.id %} selected="selected" {% endif %}>[{{ data.code }}] {{ data.description }}</option>
                            {% endfor %}
                        </select>
                        <span class="help-block form-error">{{ form.product.errors.as_text }}</span>
                    </div>
                    <div class="form-group col-sm-4 {{ form.government.errors|yesno:'has-error,' }}">
                        <label class="control-label" for="id_government">Government ?</label>
                        <select id="id_government" class="form-control input-sm select2" name="government">
                            {% for id,name in form.fields.government.choices %}
                                <option value="{{ id }}"{% if form.government.value == id %} selected{% endif %}>{% ifequal id ""%}-- Select --{% else %}{{ name }}{% endifequal %}</option>
                            {% endfor %}
                        </select>
                        <span class="help-block form-error">{{ form.government.errors.as_text }}</span>
                    </div>
                </form>
                <!-- End Simple Form Validation -->
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
</div>
{% endblock page-content %}
{% block extra_js %}
    <script src="{% static 'financial-layout/assets/plugin/bootstrap-datepicker/js/bootstrap-datepicker.min.js' %}"></script>
    <script src="{% static 'financial-layout/assets/plugin/bootstrap-datepicker/js/custom-datepicker.js' %}"></script>
    <script src="{% static 'js/jquery.validate.js' %}" type="text/javascript"></script>
    <script src="{% static 'financial-layout/assets/plugin/select2/js/select2.min.js' %}"></script>
    <script src="{% static 'js/ajaxselect2.js' %}" type="text/javascript"></script>
    <script>
    $(function(){
        ajaxselect2("agency", "id_agency");
        ajaxselect2("client", "id_client");
        ajaxselect2("agent", "id_agent");

        setPayeeOptions();

        $('#id_payee_type').on('change', function(){
            setPayeeOptions();
        });

        function setPayeeOptions(){
            $('.payee_options').hide();
            if($('#id_payee_type').val() == 'AG') $('.payee_options').hide().eq(0).show();
            else if($('#id_payee_type').val() == 'C') $('.payee_options').hide().eq(1).show();
            else $('.payee_options').hide().eq(2).show();
        }
    });
    </script>
{% endblock extra_js %}