{% load endless %}
{% load humanize %}
{% paginate data_list %}
<div class="table-responsive">
    <table class="table table-hover table-bordered">
        <thead>
            <tr>
                <th><span>ID</span></th>
                <th><span>Number</span></th>
                <th><span>Date</span></th>
                <th><span>Payee</span></th>
                <th><span>Bank</span></th>
                <th><span>Amount</span></th>
                <th><span>Approver</span></th>
                <th><span>Created by</span></th>
                <th><span>CV Status</span></th>
                <th class="text-center"><span>Action</span></th>
            </tr>
        </thead>
        <tbody>
            {% for data in data_list %}
            <tr>
                <td>{{ data.id }}</td>
                <td>{{ data.cvnum }}</td>
                <td>{{ data.cvdate|date:"Y-m-d" }}</td>
                <td>{{ data.payee_name }}</td>
                <td>{{ data.bankaccount.code }}</td>
                <td style="text-align: right;">{{ data.amount|floatformat:2|intcomma }}</td>
                <td>{% if data.actualapprover %}{{ data.actualapprover.first_name }}&nbsp;{{ data.actualapprover.last_name }}{% elif data.designatedapprover %}{{ data.designatedapprover.first_name }}&nbsp;{{ data.designatedapprover.last_name }}{% else %}-- no approver assigned yet --{% endif %}</td>
                <td>{{ data.enterby }}</td>
                <td class="tdOfStatus
                        {% if data.cvstatus == 'A' %} text-success
                        {% elif data.cvstatus == 'D' %} text-danger
                        {% elif data.cvstatus == 'F' %} text-info
                        {% elif data.cvstatus == 'R' %} text-success
                        {% endif %}">
                    <b>{{ data.get_cvstatus_display }}</b>
                </td>
                <td style="width: 115px; padding-left: 13px" class="action-btns-container">
                    <div class="iconlist-wrap auto-0">
                        <div class="iconlist" style="text-align: left">
                        <a href="{% url 'checkvoucher:detail' data.pk %}" class="btnDetail" data-toggle="tooltip" data-placement="left" data-trigger="hover" data-original-title="Click to View" title="" aria-describedby="tooltip850155">
                            <i class="icon md-view-list" aria-hidden="true">&nbsp;&nbsp;</i>
                        </a>
                        {% if perms.checkvoucher.change_cvmain and data.isdeleted == 0 %}
                        <a href="{% url 'checkvoucher:update' data.pk %}" class="btnUpdate" data-toggle="tooltip" data-placement="left" data-trigger="hover" data-original-title="Click to Edit" title="" aria-describedby="tooltip850155">
                            <i class="icon md-edit" aria-hidden="true">&nbsp;&nbsp;</i>
                        </a>
                        {% endif %}
                        {% if perms.checkvoucher.delete_cvmain and data.isdeleted == 0 and data.status == 'A' and data.cvstatus != 'A' and data.cvstatus != 'I' and data.cvstatus != 'R' %}
                        <a href="{% url 'checkvoucher:delete' data.pk %}" class="btnDelete" data-toggle="tooltip" data-placement="left" data-trigger="hover" data-original-title="Click to Cancel" title="" aria-describedby="tooltip850155">
                            <i class="icon md-delete" aria-hidden="true">&nbsp;&nbsp;</i>
                        </a>
                        {% endif %}
                        </div>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div class="pagination pull-right">{% show_pages %}</div>
</div>
<!-- required -->
<a href="/{{ request.resolver_match.app_name }}/?page=1" rel="page" class="endless_page_link" id="dummy" style="display: none;">1</a>
<script>
    $(function () {
        $('.shade').remove();
        $('.panel').prepend('<div class="shade"><div class="loader two-color"></div></div>');
        $('#searchFilter').val(getCookie('keysearch_{{ request.resolver_match.app_name }}'));
        $('.endless_page_link').on('click', function () {
            $('.shade').fadeIn();
        });
    });
</script>
