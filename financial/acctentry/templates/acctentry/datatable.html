{% for temp in datatemp %}
<tr>
    <td>{{ temp.item_counter }}</td>
    <td>{{ temp.accountcode }}</td>
    <td>{{ temp.chartofaccountdesc }}</td>
    <td class="text-align-right">{{ temp.creditamount }}</td>
    <td class="text-align-right">{{ temp.debitamount }}</td>
    <td>
        <a href="#" class="detailedit" data-id="{{ temp.id }}"><i class="icon fa-pencil" aria-hidden="true"></i></a>&nbsp;&nbsp;
        <a href="#" class="detaildelete" data-id="{{ temp.id }}"><i class="icon fa-remove" aria-hidden="true"></i></a>
    </td>
</tr>
<tr>
    <td colspan="6">
        <table class="table">
            <tr>
                <td width="5%"></td>
                {% if temp.accountnumber %}
                <td>{{ temp.accountnumber|default:'' }} - {{ temp.bankaccountcode|default:'' }}</td>
                {% endif %}
                {% if temp.departmentname %}
                <td>{{ temp.departmentname|default:'' }}</td>
                {% endif %}
                {% if temp.employeecode %}
                <td>
                    {% if temp.employeestatus == 'Y' %}
                        <a href="#">{{ temp.employeecode|default:'' }} - {{ temp.employeename|default:'' }}</a>
                    {% else %}
                        {{ temp.employeecode|default:'' }} - {{ temp.employeename|default:'' }}
                    {% endif %}
                </td>
                {% endif %}
                {% if temp.suppliercode %}
                <td>
                    {% if temp.supplierstatus == 'Y' %}
                        <a href="#">{{ temp.suppliercode|default:'' }} - {{ temp.suppliername|default:'' }}</a>
                    {% else %}
                        {{ temp.suppliercode|default:'' }} - {{ temp.suppliername|default:'' }}
                    {% endif %}
                </td>
                {% endif %}
                {% if temp.customercode %}
                <td id="tdtarget_C{{ temp.id }}">
                    {% if temp.customerstatus == 'Y' %}
                        <a href="#" data-target="#modal-row" data-backdrop="static" data-keyboard="false" data-toggle="modal" class="breakdown" data-id="{{ temp.id }}" data-chart="{{ temp.chartofaccount }}" data-type="C">{{ temp.customercode|default:'' }} - {{ temp.customername|default:'' }}</a>
                    {% else %}
                        {{ temp.customercode|default:'' }} - {{ temp.customername|default:'' }}
                    {% endif %}
                </td>
                {% endif %}
                {% if temp.unitcode %}
                <td>{{ temp.unitname|default:'' }}</td>
                {% endif %}
                {% if temp.branchcode %}
                <td>{{ temp.branchname|default:'' }}</td>
                {% endif %}
                {% if temp.productcode %}
                <td>{{ temp.productname|default:'' }}</td>
                {% endif %}
                {% if temp.inputvatcode %}
                <td>{{ temp.inputvatname|default:'' }}</td>
                {% endif %}
                {% if temp.outputvatcode %}
                <td>{{ temp.outputvatname|default:'' }}</td>
                {% endif %}
                {% if temp.vatcode %}
                <td>{{ temp.vatname|default:'' }}</td>
                {% endif %}
                {% if temp.wtaxcode %}
                <td>{{ temp.wtaxname|default:'' }}</td>
                {% endif %}
                {% if temp.ataxcode %}
                <td>{{ temp.ataxname|default:'' }}</td>
                {% endif %}
                <td></td>
            </tr>
        </table>
    </td>
</tr>
{% endfor %}

<script>
    $(function () {
        $('#total_debitamount').text("{{ datatemptotal.0.totaldebitamount }}");
        $('#total_creditamount').text("{{ datatemptotal.0.totalcreditamount }}");
    });

    $(".breakdown").click(function(){
        $("#breakdowndata").html('');
        $.ajax({
            url: "{% url 'acctentry:breakdownentry' %}",
            type: "post",
            data: {'csrfmiddlewaretoken': "{{csrf_token}}",
                'detailid': $(this).data('id'),
                'chartid': $(this).data('chart'),
                'datatype': $(this).data('type'),
                'secretkey': $("#secretkey").val(),
                'table': 'jvdetailbreakdowntemp',
                'tablemain': 'jvdetailtemp',
            },
            success: function(response) {
                $("#breakdowndata").html(response['breakdowndata']);
            },
            error: function(response) {
                console.log(response);
            }
        });
    });

    $('.detailedit').click(function(){
        var id = $(this).data('id');

        alert(id);
{#        $('.tr_data').css("background-color","");#}
{#        $("#tr_data_"+id).css('background-color', '#fa9b74');#}
{#        $("#btn_updatedetailbsubmit").attr('data-id', id);#}

        $('.btndadd').hide();
        $('.btndupdate').show();

{#        $.ajax({#}
{#            url: "{% url 'acctentry:updatebreakentry' %}",#}
{#            type: "post",#}
{#            data: {'csrfmiddlewaretoken': "{{csrf_token}}",#}
{#                   'secretkey': $("#secretkey").val(),#}
{#                   'table': 'jvdetailbreakdowntemp',#}
{#                   'id': id,#}
{#            },#}
{#            success: function(response) {#}
{#                var info = $.parseJSON(response.info)#}
{#                $("#detailb_particular").val(info[0].particular);#}
{#                $("#detailb_chartofaccount").val(info[0].chartofaccount);#}
{#                $("#detailb_bankaccount").val(info[0].bankaccount);#}
{#                $("#detailb_department").val(info[0].department);#}
{#                $("#detailb_employee").val(info[0].employee);#}
{#                $("#detailb_supplier").val(info[0].supplier);#}
{#                $("#detailb_customer").val(info[0].customer);#}
{#                $("#detailb_unit").val(info[0].unit);#}
{#                $("#detailb_branch").val(info[0].branch);#}
{#                $("#detailb_product").val(info[0].product);#}
{#                $("#detailb_inputvat").val(info[0].inputvat);#}
{#                $("#detailb_outputvat").val(info[0].outputvat);#}
{#                $("#detailb_vat").val(info[0].vat);#}
{#                $("#detailb_wtax").val(info[0].wtax);#}
{#                $("#detailb_ataxcode").val(info[0].ataxcode);#}
{#                $("#detailb_creditamount").val(info[0].creditamountformatted);#}
{#                $("#detailb_debitamount").val(info[0].debitamountformatted);#}
{#                $("#detailb_chartofaccount").focus();#}
{#            },#}
{#            error: function(response) {#}
{#                console.log(response);;#}
{#            }#}
{#        });#}
    });

    $('.detaildelete').click(function(){
        var id = $(this).data('id');
        var ans = confirm('Are you sure you want to delete this data?');

        if(ans){
            $.ajax({
                url: "{% url 'acctentry:deletedetail' %}",
                type: "post",
                data: {'csrfmiddlewaretoken': "{{csrf_token}}",
                    'id': id,
                    'secretkey': $("#secretkey").val(),
                    'table': 'jvdetailtemp',
                },
                success: function(response){
                    $("#datatable").html(response['datatable']);
                },
                error: function(response){
                    console.log(response);
                }

            });
        }
    });
</script>

