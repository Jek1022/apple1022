{% for temp in datatemp %}
<tr class="trd_data" id="trd_data_{{ temp.id }}">
    <td>{{ temp.item_counter }}</td>
    <td>{{ temp.accountcode }}</td>
    <td>{{ temp.chartofaccountdesc }}</td>
    <td class="text-align-right">{{ temp.creditamount }}</td>
    <td class="text-align-right">{{ temp.debitamount }}</td>
    <td>
        <a href="#" class="detailedit" data-id="{{ temp.id }}" data-chartid="{{ temp.chartofaccount }}"><i class="icon fa-pencil" aria-hidden="true"></i></a>&nbsp;&nbsp;
        <a href="#" class="detaildelete" data-id="{{ temp.id }}" data-chartid="{{ temp.chartofaccount }}"><i class="icon fa-remove" aria-hidden="true"></i></a>
    </td>
</tr>
<tr>
    <td colspan="6">
        <table class="table" id="breaktabledata">
            <tr>
                <td width="5%"></td>
                {% if temp.accountnumber %}
                <td>{{ temp.accountnumber|default:'' }} - {{ temp.bankaccountcode|default:'' }}</td>
                {% endif %}
                {% if temp.departmentname %}
                <td>{{ temp.departmentname|default:'' }}</td>
                {% endif %}
                {% if temp.employeecode %}
                <td id="tdtarget_E{{ temp.id }}" {% if temp.employeebreakstatus == 1 %} class="unbalancebreakdown" style="background-color:#fa9b74" {% endif %}>
                    {% if temp.employeestatus == 'Y' %}
                        <a href="#"  data-target="#modal-row" data-backdrop="static" data-keyboard="false" data-toggle="modal" class="breakdown" data-id="{{ temp.id }}" data-chart="{{ temp.chartofaccount }}" data-type="E">{{ temp.employeecode|default:'' }} - {{ temp.employeename|default:'' }}</a>
                    {% else %}
                        {{ temp.employeecode|default:'' }} - {{ temp.employeename|default:'' }}
                    {% endif %}
                </td>
                {% endif %}
                {% if temp.suppliercode %}
                <td id="tdtarget_S{{ temp.id }}" {% if temp.supplierbreakstatus == 1 %} class="unbalancebreakdown" style="background-color:#fa9b74" {% endif %}>
                    {% if temp.supplierstatus == 'Y' %}
                        <a href="#"  data-target="#modal-row" data-backdrop="static" data-keyboard="false" data-toggle="modal" class="breakdown" data-id="{{ temp.id }}" data-chart="{{ temp.chartofaccount }}" data-type="S">{{ temp.suppliercode|default:'' }} - {{ temp.suppliername|default:'' }}</a>
                    {% else %}
                        {{ temp.suppliercode|default:'' }} - {{ temp.suppliername|default:'' }}
                    {% endif %}
                </td>
                {% endif %}
                {% if temp.customercode %}
                <td id="tdtarget_C{{ temp.id }}" {% if temp.customerbreakstatus == 1 %} class="unbalancebreakdown" style="background-color:#fa9b74" {% endif %}>
                    {% if temp.customerstatus == 'Y' %}
                        <a href="#" data-target="#modal-row" data-backdrop="static" data-keyboard="false" data-toggle="modal" class="breakdown" data-id="{{ temp.id }}" data-chart="{{ temp.chartofaccount }}" data-type="C">{{ temp.customercode|default:'' }} - {{ temp.customername|default:'' }}</a>
                    {% else %}
                        {{ temp.customercode|default:'' }} - {{ temp.customername|default:'' }}
                    {% endif %}
                </td>
                {% endif %}
                {% if temp.unitcode %}
                <td>{{ temp.unitname|default:'' }}</td>
                {% endif %}
                {% if temp.branchcode %}
                <td>{{ temp.branchname|default:'' }}</td>
                {% endif %}
                {% if temp.productcode %}
                <td>{{ temp.productname|default:'' }}</td>
                {% endif %}
                {% if temp.inputvatcode %}
                <td>{{ temp.inputvatname|default:'' }}</td>
                {% endif %}
                {% if temp.outputvatcode %}
                <td>{{ temp.outputvatname|default:'' }}</td>
                {% endif %}
                {% if temp.vatcode %}
                <td>{{ temp.vatname|default:'' }}</td>
                {% endif %}
                {% if temp.wtaxcode %}
                <td>{{ temp.wtaxname|default:'' }}</td>
                {% endif %}
                {% if temp.ataxcode %}
                <td>{{ temp.ataxname|default:'' }}</td>
                {% endif %}
                <td></td>
            </tr>
        </table>
    </td>
</tr>
{% endfor %}
<script>
    $(function () {
        $('#total_debitamount').text("{{ datatemptotal.0.totaldebitamount|default_if_none:'0.00' }}");
        $('#total_creditamount').text("{{ datatemptotal.0.totalcreditamount|default_if_none:'0.00' }}");
    });

    $(".breakdown").click(function(){
        $("#breakdowndata").html('');
        $.ajax({
            url: "{% url 'acctentry:breakdownentry' %}",
            type: "post",
            data: {'csrfmiddlewaretoken': "{{csrf_token}}",
                'detailid': $(this).data('id'),
                'chartid': $(this).data('chart'),
                'datatype': $(this).data('type'),
                'secretkey': $("#secretkey").val(),
                'table': 'jvdetailbreakdowntemp',
                'tablemain': 'jvdetailtemp',
            },
            success: function(response) {
                $("#breakdowndata").html(response['breakdowndata']);
            },
            error: function(response) {
                console.log(response);
            }
        });
    });


    $('.detaildelete').click(function(){
        var id = $(this).data('id');
        var ans = confirm('Are you sure you want to delete this data?');

        if(ans){
            $.ajax({
                url: "{% url 'acctentry:deletedetail' %}",
                type: "post",
                data: {'csrfmiddlewaretoken': "{{csrf_token}}",
                    'id': id,
                    'secretkey': $("#secretkey").val(),
                    'table': 'jvdetailtemp',
                },
                success: function(response){
                    $("#datatable").html(response['datatable']);

                    $('#btn_detailcancel').trigger('click');
                },
                error: function(response){
                    console.log(response);
                }

            });
        }
    });
</script>

